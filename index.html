<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Annuaire</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>
<body>

<div class="container">
    <h1 style="text-align: center">Annuaire</h1>
    <div class="row">
        <div class="form-horizontal">
            <div class="form-group">
                <label for="nom" class="col-sm-2 control-label">Nom</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="nom">
                </div>
            </div>
        </div>
    </div>
    <br><br>
    <div class="row">
        <table id="resultats" class="table table-hover table-striped">
            <tr>
                <th>CN</th>
                <th>Nom</th>
                <th>Prénom</th>
                <th>Email</th>
                <th>Département</th>
                <th>Etablissement</th>
                <th>Téléphone</th>
            </tr>
        </table>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
<script>
    var inputNom = $("#nom");
    var inputPrenom = $("#prenom");

    function search() {
        if (inputNom.val().length > 2) {
            $.ajax({
                url: "http://ldap-webcom.kermit.rd.francetelecom.fr/api/v1/users?name=" + inputNom.val()
            }).done(function (data) {
                console.log(data);
                $.each(data.results, function (index, valeur) {
                    $("#resultats").append($("<tr>")
                            .addClass("lignesResultats")
                            .append($("<td>").html(valeur.cn))
                            .append($("<td>").html(valeur.sn))
                            .append($("<td>").html(valeur.givenname))
                            .append($("<td>").html(valeur.mail))
                            .append($("<td>").html(valeur.department))
                            .append($("<td>").html(valeur.l))
                            .append($("<td>").html('<a href="http://annuaire.sso.infra.ftgroup/clickvoice?phone=' + valeur.telephonenumber + '">' + valeur.telephonenumber + '</a>'))
                    );
                });
            });
        }
    }

    $("body").keypress(function(e){
        if(e.keyCode == 13) {
            $(".lignesResultats").remove();
            search();
        }
    });
    $("document").ready(function(){
        inputNom.focus();
    });
</script>
</body>
</html>
